<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trading System Console</title>
  <link rel="stylesheet" href="/styles.css" />
  <script src="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js"></script>
</head>
<body>
  <nav class="nav">
    <a href="#/monitor" id="tab-monitor">Home</a>
    <a href="#/account" id="tab-account">Accounts</a>
    <a href="#/settings" id="tab-settings">Settings</a>
  </nav>
  <main id="app">
    <!-- Home -->
    <section v-if="route==='monitor'">
      <div class="card">
        <h3>Create Subscription</h3>
        <div class="row">
          <input class="input" placeholder="Name" v-model="homeForm.name">
          <select class="input" v-model="homeForm.coin">
            <option value="ETH">ETH</option>
          </select>
          <select class="input" v-model="homeForm.interval">
            <option value="1m">1m</option>
            <option value="5m">5m</option>
            <option value="15m">15m</option>
          </select>
          <select class="input" v-model="homeForm.account_alias">
            <option value="">Default</option>
            <option v-for="a in accounts" :key="a.id" :value="a.alias">{{ a.alias }}</option>
          </select>
          <button class="btn" @click="createHome">Create</button>
          <button class="btn ghost" @click="clearAll">Pause / Clear</button>
        </div>
      </div>

      <div class="card">
        <div class="stat">
          <div class="kpi"><div class="value">{{ status.ws_ready ? 'Yes' : 'No' }}</div><div class="label">WS Ready</div></div>
          <div class="kpi"><div class="value">{{ status.active_subscriptions }}</div><div class="label">Active</div></div>
          <div class="kpi"><div class="value">{{ status.subscription_stats?.total ?? 0 }}</div><div class="label">Total</div></div>
        </div>
      </div>

      <div class="card">
        <h3>Current Subscriptions</h3>
        <table class="table">
          <thead><tr><th>ID</th><th>Type</th><th>Status</th><th>Action</th></tr></thead>
          <tbody>
            <tr v-for="s in subs" :key="s.id">
              <td>{{ s.id }}</td>
              <td>{{ s.type }}</td>
              <td>{{ s.status }}</td>
              <td><button class="btn danger" @click="removeSub(s.id)">Delete</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Accounts -->
    <section v-if="route==='account'">
      <div class="card">
        <h3>Create / Update Account</h3>
        <div class="row">
          <input class="input" placeholder="Alias" v-model="accountForm.alias">
          <input class="input" placeholder="API Wallet Address" v-model="accountForm.api_wallet_address">
          <input class="input" placeholder="Secret Key" v-model="accountForm.secret_key">
          <button class="btn" @click="saveAccount">Save</button>
        </div>
      </div>
      <div class="card">
        <h3>Account List</h3>
        <table class="table">
          <thead><tr><th>Alias</th><th>Account Address</th><th>API Wallet</th><th>Active</th><th>Action</th></tr></thead>
          <tbody>
            <tr v-for="a in accounts" :key="a.id">
              <td>{{ a.alias }}</td>
              <td>{{ a.account_address }}</td>
              <td>{{ a.api_wallet_address }}</td>
              <td>{{ a.is_active ? 'Yes' : 'No' }}</td>
              <td><button class="btn danger" @click="deleteAccount(a.alias)">Delete</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Settings -->
    <section v-if="route==='settings'">
      <div class="card">
        <h3>Create / Update Config</h3>
        <div class="row">
          <input class="input" placeholder="key" v-model="configForm.key">
          <input class="input" placeholder="value" v-model="configForm.value">
          <input class="input" placeholder="description" v-model="configForm.description">
          <input class="input" placeholder="config_type" v-model="configForm.config_type">
          <button class="btn" @click="saveConfig">Save</button>
        </div>
      </div>
      <div class="card">
        <h3>Config List</h3>
        <table class="table">
          <thead><tr><th>Key</th><th>Value</th><th>Type</th><th>Description</th><th>Action</th></tr></thead>
          <tbody>
            <tr v-for="c in configs" :key="c.id">
              <td>{{ c.key }}</td>
              <td style="max-width:360px;overflow:auto">{{ c.value }}</td>
              <td>{{ c.config_type }}</td>
              <td>{{ c.description }}</td>
              <td><button class="btn danger" @click="deleteConfig(c.key)">Delete</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>
  <script src="/main.js"></script>
</body>
</html>


